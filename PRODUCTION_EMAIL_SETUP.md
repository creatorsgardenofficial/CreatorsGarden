# 本番環境でのメール送信設定

## 📋 本番環境での動作

本番環境（`NODE_ENV=production`）では、**環境変数が設定されていなくてもメール送信を試行**します。

ただし、**実際にメールを送信するには、環境変数の設定が必要**です。

## ⚠️ 重要な注意事項

### 環境変数が設定されていない場合

本番環境でSMTP設定がない場合：
- メール送信を試行しますが、**失敗します**
- エラーログが出力されます
- フォールバックとして、メール内容が`data/emails/`フォルダに保存されます
- ユーザーには成功メッセージが表示されます（セキュリティのため）

### 環境変数が設定されている場合

本番環境でSMTP設定がある場合：
- ✅ 実際のメールアドレスにメールが送信されます

## 🔧 本番環境での推奨設定

本番環境では、必ず以下の環境変数を設定してください：

```env
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=your-email@gmail.com
SMTP_PASS=your-app-password
SMTP_FROM_EMAIL=your-email@gmail.com
SMTP_FROM_NAME=Creators Garden
```

## 📦 デプロイ時の設定方法

### Vercelを使用する場合

1. Vercelダッシュボードでプロジェクトを開く
2. 「Settings」→「Environment Variables」を開く
3. 上記の環境変数を追加

### その他のホスティングサービス

各ホスティングサービスの環境変数設定画面で、上記の環境変数を設定してください。

## 🔍 トラブルシューティング

### メールが送信されない場合

1. **環境変数の確認**
   - 本番環境の環境変数設定を確認
   - `SMTP_HOST`, `SMTP_USER`, `SMTP_PASS`が正しく設定されているか

2. **ログの確認**
   - サーバーログでエラーメッセージを確認
   - `Failed to send password reset email`というエラーが出ていないか

3. **メール送信サービスの確認**
   - Gmailの場合、アプリパスワードが正しいか確認
   - 2段階認証が有効になっているか確認

## ✅ 動作確認

本番環境でパスワードリセット申請を行い、実際のメールアドレスにメールが届くか確認してください。

メールが届かない場合：
- サーバーログを確認
- 環境変数が正しく設定されているか確認
- メール送信サービスの設定を確認

