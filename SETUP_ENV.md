# 環境変数設定完了ガイド

## ✅ `.env.local`ファイルの作成完了

`.env.local`ファイルが作成されました。次に、実際のStripe APIキーと価格IDを設定してください。

---

## 🔧 設定手順

### 1. Stripeアカウントのセットアップ

1. [Stripe](https://stripe.com)にアクセスしてアカウントを作成（無料）
2. ダッシュボードにログイン: https://dashboard.stripe.com
3. 「開発者」→「APIキー」を開く
4. 以下のキーをコピー：
   - **シークレットキー**（`sk_test_...`で始まる）
   - **公開可能キー**（`pk_test_...`で始まる）

### 2. 価格（プラン）の作成

1. Stripeダッシュボードで「製品」→「価格を追加」をクリック
2. 以下の設定で価格を作成：
   - **価格タイプ**: 定期（サブスクリプション）
   - **価格**: ¥200
   - **通貨**: JPY（日本円）
   - **請求期間**: 月次
   - **価格ID**をコピー（`price_...`で始まる）

### 3. `.env.local`ファイルの編集

プロジェクトルート（`creator-collab`フォルダ）の`.env.local`ファイルを開き、以下の値を実際の値に置き換えてください：

```env
# Stripe API Keys
STRIPE_SECRET_KEY=sk_test_実際のシークレットキーをここに貼り付け
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_test_実際の公開キーをここに貼り付け

# Stripe Price IDs
STRIPE_PRICE_ID_GROW=price_実際の価格IDをここに貼り付け

# ベースURL（開発環境）
NEXT_PUBLIC_BASE_URL=http://localhost:3000
```

**注意**: 
- `STRIPE_WEBHOOK_SECRET`は後で設定します（Webhook設定時）
- `STRIPE_PRICE_ID_BLOOM`はBloom Plan実装時に設定

### 4. サーバーの再起動

環境変数を変更した後は、開発サーバーを再起動してください：

```bash
# サーバーを停止（Ctrl+C）
# その後、再起動
npm run dev
```

---

## 🔍 動作確認

### 1. 環境変数の確認

サーバーを起動した後、コンソールに警告メッセージが表示されないことを確認してください。

### 2. プランページの確認

1. ブラウザで `http://localhost:3000/pricing` にアクセス
2. プラン選択画面が表示されることを確認
3. Grow Planの「プランを選択」ボタンをクリック
4. Stripeの決済画面が表示されることを確認

### 3. テストカードでの決済テスト

Stripeテスト環境では以下のカード番号が使用できます：

- **成功**: `4242 4242 4242 4242`
- **3Dセキュア認証**: `4000 0025 0000 3155`
- **失敗**: `4000 0000 0000 0002`

有効期限: 任意の未来の日付（例: 12/25）  
CVC: 任意の3桁（例: 123）  
郵便番号: 任意（例: 12345）

---

## ⚠️ トラブルシューティング

### 警告: "STRIPE_SECRET_KEYが設定されていません"

→ `.env.local`の`STRIPE_SECRET_KEY`が正しく設定されているか確認
→ サーバーを再起動してください

### エラー: "プランの価格IDが設定されていません"

→ `.env.local`の`STRIPE_PRICE_ID_GROW`が正しく設定されているか確認
→ 価格IDが`price_`で始まっているか確認

### エラー: "Stripe公開キーが設定されていません"

→ `.env.local`の`NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY`が正しく設定されているか確認
→ `NEXT_PUBLIC_`プレフィックスが付いているか確認

### 決済画面が表示されない

→ ブラウザのコンソール（F12）でエラーを確認
→ サーバーログでエラーを確認
→ Stripe APIキーが正しいか確認

---

## 📋 チェックリスト

- [ ] Stripeアカウントを作成
- [ ] APIキーを取得（シークレットキーと公開キー）
- [ ] 価格（プラン）を作成
- [ ] `.env.local`ファイルを編集して実際の値を設定
- [ ] サーバーを再起動
- [ ] プランページにアクセス
- [ ] テスト決済を実行

---

## 📚 参考資料

- **環境変数設定ガイド**: `ENV_SETUP_GUIDE.md`
- **クイックスタート**: `QUICK_START_STRIPE.md`
- **詳細セットアップ**: `STRIPE_SETUP.md`
- **テンプレートファイル**: `env.local.template`

---

環境変数の設定が完了したら、Stripe決済機能が利用可能になります！🎉

